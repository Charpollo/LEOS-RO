# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

LEOS Red Orbit is a space disaster simulation platform built on top of LEOS First Orbit. It combines the educational 3D satellite visualization features of First Orbit with advanced physics-based disaster modeling capabilities. The project simulates scenarios like Kessler Syndrome, solar storms, and satellite conjunctions using Babylon.js for rendering and Ammo.js for physics.

## Architecture

### Frontend Structure

#### First Orbit Components (Educational - KEEP ALL)
- **Entry Point**: `frontend/js/app.js` - Main application initialization
- **3D Rendering**: Babylon.js engine with custom Earth, Moon, and satellite meshes
- **Core Components**: 
  - `satellites.js` - Satellite mesh creation and orbital mechanics
  - `earth.js` - Earth rendering with textures and atmosphere
  - `moon.js` - Moon rendering and orbital positioning
  - `telemetry.js` - Real-time telemetry data handling
  - `simulation.js` - Time-based simulation loop
  - `groundStations.js` - Ground station network and line-of-sight calculations
- **UI System**: Custom UI manager with brand components and telemetry cards
- **Data Integration**: Flexible data source system supporting files, APIs, and WebSocket streams

#### Red Orbit Components (Disaster Simulation - NEW)
- **Physics Engine**: `frontend/js/red-orbit/physics/` - Ammo.js integration
- **Disaster Scenarios**: `frontend/js/red-orbit/scenarios/` - Kessler, solar storms, conjunctions
- **Simulation Core**: `frontend/js/red-orbit/core/` - Red Orbit engine and scene management
- **UI Extensions**: `frontend/js/red-orbit/ui/` - Disaster-specific controls and displays

### Backend
- **Server**: Simple Python HTTP server (`server.py`) that serves the built frontend
- **Build System**: Webpack configuration for bundling JavaScript modules and assets

## Common Development Commands

### Build and Development
```bash
# Clean build directory
npm run clean

# Build for development
npm run build

# Build for production
NODE_ENV=production npm run build

# Watch mode for development
npm run watch

# Start development server (with clean build)
npm run dev
# or
./run-frontend.sh --clean --port 8000

# Start server on default port 8080
npm start
# or
./run-frontend.sh
```

### Server Operations
```bash
# Start server with custom port
./run-frontend.sh --port 3000

# Start server with clean build
./run-frontend.sh --clean

# Kill all server processes
./kill.sh
```

## Key Technologies

- **Babylon.js**: 3D rendering engine for satellite and Earth visualization
- **Ammo.js**: Physics engine for collision detection and debris dynamics
- **satellite.js**: Orbital mechanics calculations and TLE parsing
- **Webpack**: Module bundler for JavaScript and assets
- **Python**: Backend HTTP server
- **CSS**: Custom styling for UI components

## Data Sources Integration

The system supports multiple telemetry data sources as documented in `DATA_SOURCE_INTEGRATION.md`:
- Static files (JSON, JSONL, CSV)
- REST APIs with field mapping
- WebSocket real-time streams
- File uploads through UI

Press `Ctrl+D` to open the Data Source Manager for configuring telemetry inputs.

## Development Notes

- The application uses a modular JavaScript architecture with ES6 imports
- Babylon.js scenes are initialized in `app.js` with separate modules for each 3D component
- UI components are custom-built with a template system
- Telemetry data is processed through a standardized format with field mapping support
- The simulation uses configurable time multipliers for orbital mechanics calculations
- Red Orbit adds physics-based collision detection using Ammo.js
- Disaster scenarios implement NASA Standard Breakup Model for debris generation
- Performance modes allow scaling from 1,000 to 10,000+ tracked objects

## File Structure Notes

- `frontend/dist/` - Built assets (generated by webpack)
- `frontend/assets/` - Static assets (textures, models, data files)
- `frontend/js/` - Source JavaScript modules (First Orbit core)
- `frontend/js/red-orbit/` - Red Orbit disaster simulation modules
- `frontend/css/` - Stylesheets
- `frontend/css/red-orbit/` - Red Orbit specific styles
- `frontend/templates/` - HTML templates for UI components
- `docs/` - Documentation including integration guide