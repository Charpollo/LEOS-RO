<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEOS: First Orbit - Satellite Visualization</title>
    <link rel="stylesheet" href="css/brand-ui.css">
    <link rel="stylesheet" href="css/sda-styles.css">
    <!-- Webpack will inject the correct script tags automatically -->
    <style>
      /* Help modal side panel */
      /* Pulsing glow for help sphere */
      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(0,204,255,0.7); }
        70% { box-shadow: 0 0 0 12px rgba(0,204,255,0); }
        100% { box-shadow: 0 0 0 0 rgba(0,204,255,0); }
      }
      #help-sphere-btn {
        pointer-events: auto;
        animation: pulse 3s ease-in-out infinite;
        color: #fff;
        font-size: 1.2em;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #help-sphere-btn:hover {
        background: rgba(102,217,255,0.9);
      }
      /* Apply pulse animation to SDA toggle button */
      #sda-toggle-btn {
        animation: pulse 3s ease-in-out infinite;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
      }
      
      /* Apply pulse animation to simulation settings button */
      #simulation-settings-btn {
        animation: pulse 3s ease-in-out infinite;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
      }

    </style>
</head>
<body>
    <div id="renderCanvas-container">
        <!-- Help Sphere Button (hidden until simulation starts) -->
        <button id="help-sphere-btn" title="Help" style="position:absolute; top:16px; left:16px; width:36px; height:36px; border-radius:50%; background:rgba(102,217,255,0.7); border:2px solid #00cfff; cursor:pointer; z-index:5000; display:none; pointer-events:auto;">i</button>
        
        <!-- SDA Toggle Button (hidden until simulation starts) -->
        <button id="sda-toggle-btn" title="Toggle SDA" style="position:absolute; top:60px; left:16px; width:36px; height:36px; border-radius:50%; background:rgba(102,217,255,0.7); border:2px solid #00cfff; cursor:pointer; z-index:5000; display:none; pointer-events:auto; align-items:center; justify-content:center;">
            <img src="/assets/sat.svg" style="width:18px; height:18px; filter:brightness(0) invert(1);" alt="SDA">
        </button>
        
        <!-- Simulation Settings Button (hidden until simulation starts) -->
        <button id="simulation-settings-btn" title="Simulation Settings" style="position:absolute; top:104px; left:16px; width:36px; height:36px; border-radius:50%; background:rgba(102,217,255,0.7); border:2px solid #00cfff; cursor:pointer; z-index:5000; display:none; pointer-events:auto; align-items:center; justify-content:center;">
            <svg style="width:18px; height:18px; fill:#ffffff;" viewBox="0 0 24 24">
                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
            </svg>
        </button>
        
        <canvas id="renderCanvas" touch-action="none"></canvas>
        <!-- Loading Screen with Space Facts -->
        
        <!-- SDA Objects Legend (hidden by default) -->
        <div class="sda-legend" id="sda-legend">
            <h4>Space Objects <span id="sda-object-count" style="color: #00cfff; font-weight: normal;">(0 objects)</span></h4>
            <div class="sda-legend-item">
                <div class="sda-legend-color leo"></div>
                <span>LEO (160-2,000 km)</span>
            </div>
            <div class="sda-legend-item">
                <div class="sda-legend-color meo"></div>
                <span>MEO (2,000-35,786 km)</span>
            </div>
            <div class="sda-legend-item">
                <div class="sda-legend-color geo"></div>
                <span>GEO (~35,786 km)</span>
            </div>
            <div class="sda-legend-item">
                <div class="sda-legend-color heo"></div>
                <span>HEO (Highly Elliptical)</span>
            </div>
            <div class="sda-legend-item">
                <div class="sda-legend-color user"></div>
                <span>User-Added Objects</span>
            </div>
        </div>
        
        <!-- Add TLE Button (hidden by default) -->
        <button class="add-tle-button" id="add-tle-button">
            Add New Object (TLE) - Coming Soon
        </button>
        <div id="loading-screen">
            <!-- Aurora Background Canvas -->
            <canvas id="aurora-canvas" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1001;"></canvas>
            <div class="loading-content">
                <div class="leos-logo"><span class="highlight">LEOS</span>: First Orbit</div>
                <div class="loading-subtitle">
                    <span class="subtitle-word">Discover.</span>
                    <span class="subtitle-word">Engage.</span>
                    <span class="subtitle-word">Explore.</span>
                </div>
                <div id="loadingWave" class="loading-wave">Launching...</div>
                <div class="space-fact" id="space-fact">
                    <p>Did you know? There are over 34,000 objects larger than 10cm currently orbiting Earth.</p>
                </div>
            </div>
        </div>

        <!-- Welcome Modal (Combined Info & Tutorial) -->
        <div id="welcome-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto; padding: 2em;">
                <h2 class="modal-title">Welcome to LEOS: First Orbit</h2>
                <div class="modal-subtitle" style="margin: 0.5em 0 2em 0; font-style: italic;">Discover. Engage. Explore.</div>
                
                <!-- Mission Introduction -->
                <div style="background: linear-gradient(135deg, rgba(0,207,255,0.1) 0%, rgba(0,207,255,0.05) 100%); padding: 25px; border-radius: 12px; margin-bottom: 3em; border-left: 4px solid #00cfff;">
                    <p style="margin: 0 0 20px 0; font-size: 1.15em; line-height: 1.7; color: #e0e0e0;">LEOS: First Orbit places you in the heart of real-time space operations. Track CRTS-1 and Bulldog as they move through Low Earth Orbit, observe orbital mechanics in action, and explore a fully interactive 3D view of Earth, the Moon, and surrounding space.</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-top: 20px;">
                        <div style="background: rgba(0,0,0,0.4); padding: 18px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0; display: flex; align-items: center;"><img src="/assets/sat.svg" style="width:24px; height:24px; margin-right:10px;"> <strong style="color: #00cfff; font-size: 1.1em;">CRTS-1</strong></p>
                            <p style="margin: 10px 0 0 0; font-size: 0.95em; color: #ccc; line-height: 1.5;">Captures Earth imagery with advanced optical sensors</p>
                        </div>
                        <div style="background: rgba(0,0,0,0.4); padding: 18px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0; display: flex; align-items: center;"><img src="/assets/sat.svg" style="width:24px; height:24px; margin-right:10px;"> <strong style="color: #00cfff; font-size: 1.1em;">Bulldog</strong></p>
                            <p style="margin: 10px 0 0 0; font-size: 0.95em; color: #ccc; line-height: 1.5;">Experimental support and research platform</p>
                        </div>
                    </div>
                </div>

                <!-- Section Divider -->
                <div style="height: 2px; background: linear-gradient(90deg, transparent 0%, #00cfff 50%, transparent 100%); margin: 3em 0; opacity: 0.3;"></div>

                <!-- Two Column Layout for Main Content -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3em; margin-bottom: 3em;">
                    
                    <!-- Left Column: Controls -->
                    <div style="background: linear-gradient(135deg, rgba(0,207,255,0.08) 0%, rgba(0,207,255,0.04) 100%); padding: 25px; border-radius: 12px; border-left: 4px solid #00cfff;">
                        <h3 style="color: #66d9ff; margin: 0 0 20px 0; font-size: 1.3em; display: flex; align-items: center;">
                            <span style="background: #00cfff; color: #000; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; font-size: 0.9em;">1</span>
                            Controls & Navigation
                        </h3>
                        <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">Mouse Drag</span>
                                <span class="control-desc">Rotate Earth view</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">Mouse Wheel</span>
                                <span class="control-desc">Zoom in/out</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">Space Key</span>
                                <span class="control-desc">Pause/Resume</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">R Key</span>
                                <span class="control-desc">Reset view</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">O Key</span>
                                <span class="control-desc">Cycle orbit display</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">Click Satellite</span>
                                <span class="control-desc">View satellite info</span>
                            </div>
                            <div class="control-item" style="margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <span class="control-key">Click Ground Station</span>
                                <span class="control-desc">View ground station info</span>
                            </div>
                            <div class="control-item" style="padding: 8px 0;">
                                <span class="control-key">Click Time Display</span>
                                <span class="control-desc">Open time controls</span>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Simulation Info -->
                    <div style="background: linear-gradient(135deg, rgba(0,207,255,0.08) 0%, rgba(0,207,255,0.04) 100%); padding: 25px; border-radius: 12px; border-left: 4px solid #00cfff;">
                        <h3 style="color: #66d9ff; margin: 0 0 20px 0; font-size: 1.3em; display: flex; align-items: center;">
                            <span style="background: #00cfff; color: #000; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; font-size: 0.9em;">2</span>
                            Simulation Speed & Time
                        </h3>
                        <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; margin-bottom: 18px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0 0 12px 0; color: #00cfff; font-weight: 600; font-size: 1.05em;">Base Time Acceleration: 60:1 ratio</p>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.95em; line-height: 1.7;">
                                <li>1 real minute = 1 simulated hour</li>
                                <li>1 real hour = 1 simulated day</li>
                                <li>24 real hours = 1 simulated month</li>
                            </ul>
                        </div>
                        <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0 0 12px 0; color: #00cfff; font-weight: 600; font-size: 1.05em;">Speed Settings:</p>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.95em; line-height: 1.7;">
                                <li><strong style="color: #66d9ff;">0.25x:</strong> Ultra-slow motion (4 orbits/hour)</li>
                                <li><strong style="color: #66d9ff;">1.0x:</strong> Default speed (16 orbits/hour)</li>
                                <li><strong style="color: #66d9ff;">4.0x:</strong> Fast forward (64 orbits/hour)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Section Divider -->
                <div style="height: 2px; background: linear-gradient(90deg, transparent 0%, #00cfff 50%, transparent 100%); margin: 3em 0; opacity: 0.3;"></div>

                <!-- Bottom Section: Satellite Facts -->
                <div style="background: linear-gradient(135deg, rgba(0,207,255,0.08) 0%, rgba(0,207,255,0.04) 100%); padding: 25px; border-radius: 12px; margin-bottom: 3em; border-left: 4px solid #00cfff;">
                    <h3 style="color: #66d9ff; margin: 0 0 20px 0; font-size: 1.3em; display: flex; align-items: center;">
                        <span style="background: #00cfff; color: #000; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; font-size: 0.9em;">3</span>
                        Satellite Orbital Facts
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                        <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0 0 12px 0; color: #00cfff; font-weight: 600; font-size: 1.05em;">Typical LEO Satellite (like ISS):</p>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.95em; line-height: 1.7;">
                                <li>Orbits Earth every ~90 minutes</li>
                                <li>Completes ~16 orbits per Earth day</li>
                                <li>Altitude: ~410km above Earth</li>
                                <li>Speed: ~7.66 km/s (17,150 mph)</li>
                            </ul>
                        </div>
                        <div style="background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; border: 1px solid rgba(0,207,255,0.2);">
                            <p style="margin: 0 0 12px 0; color: #00cfff; font-weight: 600; font-size: 1.05em;">In this simulation:</p>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.95em; line-height: 1.7;">
                                <li>Realistic orbital mechanics</li>
                                <li>Synchronized Earth rotation</li>
                                <li>Accurate day/night terminator</li>
                                <li>Seasons change every ~6 real days</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Section Divider -->
                <div style="height: 2px; background: linear-gradient(90deg, transparent 0%, #00cfff 50%, transparent 100%); margin: 2em 0; opacity: 0.3;"></div>

                <!-- Footer -->
                <div style="text-align: center; margin-top: 2em;">
                    <p class="section-content" style="margin-bottom: 2em; font-style: italic; color: #aaa; font-size: 0.95em;">
                        Use the <img src="/assets/sat.svg" style="width:16px; height:16px; vertical-align:middle;"> icon to access the Space Domain Awareness overlay.
                    </p>
                    <button id="got-it-btn" class="primary-button" style="padding: 18px 45px; font-size: 1.2em; background: linear-gradient(135deg, #00cfff 0%, #0099cc 100%); border: none; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,207,255,0.3); transition: all 0.3s ease;">Got it, let's go!</button>
                </div>
            </div>
        </div>

        
        <!-- SDA Info Modal (Welcome-style) -->
        <div id="sda-welcome-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content sda-modal">
                <div class="modal-header" style="position: relative;">
                    <button class="close-button" id="sda-modal-close" style="position: absolute; top: -5px; right: 5px; background: none; border: none; color: #66d9ff; font-size: 24px; cursor: pointer; z-index: 10;">&times;</button>
                    <h2>Space Domain Awareness</h2>
                    <p class="modal-subtitle">Real-time visualization of 15,000+ orbital objects</p>
                </div>
                <div class="modal-body">
                    <div class="info-section">
                        <h3>What is SDA?</h3>
                        <p style="margin-bottom: 1.2em;">Space Domain Awareness provides comprehensive knowledge of space objects, their activities, and the space environment.</p>
                        <p>This visualization shows thousands of active satellites, debris, and other orbital objects in real-time.</p>
                    </div>
                    
                    <div class="info-section">
                        <h3>Object Categories</h3>
                        <div class="category-grid">
                            <div class="category-item">
                                <div class="category-color" style="background: cyan;"></div>
                                <span><strong>LEO</strong> - Low Earth Orbit (160-2000 km)</span>
                            </div>
                            <div class="category-item">
                                <div class="category-color" style="background: yellow;"></div>
                                <span><strong>MEO</strong> - Medium Earth Orbit (2000-35,786 km)</span>
                            </div>
                            <div class="category-item">
                                <div class="category-color" style="background: red;"></div>
                                <span><strong>GEO</strong> - Geostationary Orbit (~35,786 km)</span>
                            </div>
                            <div class="category-item">
                                <div class="category-color" style="background: purple;"></div>
                                <span><strong>HEO</strong> - High Elliptical Orbit (>35,786 km)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <h3>Data Sources</h3>
                        <ul class="data-list">
                            <li><strong>Starlink:</strong> 4,000+ satellites for global internet</li>
                            <li><strong>OneWeb:</strong> 500+ LEO communication satellites</li>
                            <li><strong>Kuiper:</strong> 2,500+ planned Amazon satellites</li>
                            <li><strong>GPS/Galileo/GLONASS:</strong> Navigation constellations</li>
                            <li><strong>Debris:</strong> 8,000+ tracked orbital debris objects</li>
                            <li><strong>Other:</strong> Scientific, military, and commercial satellites</li>
                        </ul>
                    </div>
                    
                    <div class="info-section">
                        <h3>Beta Version</h3>
                        <p style="margin-bottom: 1.2em;">This is a beta visualization with new features and add-ons becoming available soon:</p>
                        <ul class="tips-list">
                            <li>Custom TLE upload and tracking</li>
                            <li>Collision prediction algorithms</li>
                            <li>Debris cloud analysis</li>
                            <li>Ground track visualization</li>
                            <li>Historical orbit reconstruction</li>
                        </ul>
                    </div>
                    
                    <div class="info-section">
                        <h3>Controls & Tips</h3>
                        <ul class="tips-list">
                            <li><strong>Toggle SDA:</strong> Click the <img src="/assets/sat.svg" style="width:14px; height:14px; vertical-align:middle;"> button</li>
                            <li><strong>Hover objects:</strong> View detailed satellite information</li>
                            <li><strong>Object density:</strong> 15,000+ objects for realistic scale</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="primary-button" id="sda-activate-button">Activate SDA Visualization</button>
                    <button class="secondary-button" id="sda-modal-close-footer">Close</button>
                </div>
            </div>
        </div>
        
        <!-- Simulation Settings Modal -->
        <div id="simulation-settings-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow: hidden;">
                <div class="modal-header" style="position: relative;">
                    <button class="close-button" id="settings-modal-close" style="position: absolute; top: -5px; right: 5px; background: none; border: none; color: #66d9ff; font-size: 24px; cursor: pointer; z-index: 10;">&times;</button>
                    <h2 class="modal-title">Simulation Settings</h2>
                    <p class="modal-subtitle">Configure simulation parameters and display options</p>
                </div>
                
                <!-- Tab Navigation -->
                <div class="tab-nav" style="display: flex; border-bottom: 1px solid #00cfff; margin-bottom: 20px;">
                    <button class="tab-button active" data-tab="general" style="flex: 1; padding: 12px; background: rgba(0,207,255,0.2); border: none; color: #66d9ff; cursor: pointer; border-bottom: 2px solid #00cfff; transition: all 0.3s ease; font-size: 14px; font-weight: 500;">‚è±Ô∏è General</button>
                    <button class="tab-button disabled" data-tab="visual" style="flex: 1; padding: 12px; background: rgba(0,23,40,0.3); border: none; color: #555; cursor: not-allowed; border-bottom: 2px solid transparent; transition: all 0.3s ease; font-size: 14px; font-weight: 500;">üé® Visual<br><small>Coming Soon</small></button>
                    <button class="tab-button disabled" data-tab="trails" style="flex: 1; padding: 12px; background: rgba(0,23,40,0.3); border: none; color: #555; cursor: not-allowed; border-bottom: 2px solid transparent; transition: all 0.3s ease; font-size: 14px; font-weight: 500;">üåå Trails<br><small>Coming Soon</small></button>
                    <button class="tab-button disabled" data-tab="camera" style="flex: 1; padding: 12px; background: rgba(0,23,40,0.3); border: none; color: #555; cursor: not-allowed; border-bottom: 2px solid transparent; transition: all 0.3s ease; font-size: 14px; font-weight: 500;">üìπ Camera<br><small>Coming Soon</small></button>
                    <button class="tab-button disabled" data-tab="advanced" style="flex: 1; padding: 12px; background: rgba(0,23,40,0.3); border: none; color: #555; cursor: not-allowed; border-bottom: 2px solid transparent; transition: all 0.3s ease; font-size: 14px; font-weight: 500;">üî¨ Advanced<br><small>Coming Soon</small></button>
                </div>
                
                <div class="modal-body" style="max-height: 60vh; overflow-y: auto; padding-right: 10px;">
                    <!-- General Tab -->
                    <div class="tab-content active" id="general-tab">
                        <div class="setting-section">
                            <h3>‚è±Ô∏è Time Control</h3>
                            <div class="setting-item">
                                <label for="time-multiplier-range">Simulation Speed:</label>
                                <input type="range" id="time-multiplier-range" min="0.25" max="4.0" step="0.25" value="1.0">
                                <span id="time-multiplier-value">1.0x</span>
                            </div>
                            <div class="setting-item">
                                <div class="speed-presets" style="display: flex; gap: 8px; margin-top: 8px;">
                                    <button class="speed-preset-btn" data-speed="0.25" style="padding: 4px 8px; background: rgba(0,207,255,0.2); border: 1px solid #00cfff; color: #66d9ff; border-radius: 4px; cursor: pointer; font-size: 12px;">0.25x</button>
                                    <button class="speed-preset-btn" data-speed="0.5" style="padding: 4px 8px; background: rgba(0,207,255,0.2); border: 1px solid #00cfff; color: #66d9ff; border-radius: 4px; cursor: pointer; font-size: 12px;">0.5x</button>
                                    <button class="speed-preset-btn active" data-speed="1.0" style="padding: 4px 8px; background: rgba(0,207,255,0.4); border: 1px solid #00cfff; color: #fff; border-radius: 4px; cursor: pointer; font-size: 12px;">1.0x</button>
                                    <button class="speed-preset-btn" data-speed="2.0" style="padding: 4px 8px; background: rgba(0,207,255,0.2); border: 1px solid #00cfff; color: #66d9ff; border-radius: 4px; cursor: pointer; font-size: 12px;">2.0x</button>
                                    <button class="speed-preset-btn" data-speed="4.0" style="padding: 4px 8px; background: rgba(0,207,255,0.2); border: 1px solid #00cfff; color: #66d9ff; border-radius: 4px; cursor: pointer; font-size: 12px;">4.0x</button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <label for="timezone-select">Display Timezone:</label>
                                <select id="timezone-select">
                                    <option value="UTC" selected>UTC (Universal)</option>
                                    <option value="local">Local Time</option>
                                    <option value="EST">EST (Eastern)</option>
                                    <option value="CST">CST (Central)</option>
                                    <option value="MST">MST (Mountain)</option>
                                    <option value="PST">PST (Pacific)</option>
                                    <option value="CET">CET (Central European)</option>
                                    <option value="JST">JST (Japan)</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-section">
                            <h3>‚ö° Performance</h3>
                            <div class="setting-item">
                                <label for="render-quality">Render Quality:</label>
                                <select id="render-quality">
                                    <option value="low">Low (better performance)</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                    <option value="ultra">Ultra (best quality)</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label for="update-frequency">Update Frequency:</label>
                                <input type="range" id="update-frequency" min="30" max="120" step="15" value="60">
                                <span id="update-frequency-value">60 FPS</span>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="adaptive-quality" checked>
                                    Adaptive Quality (adjust for performance)
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-fps-counter">
                                    Show FPS Counter
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Visual Tab -->
                    <div class="tab-content" id="visual-tab" style="display: none;">
                        <div class="setting-section">
                            <h3>üé® Visual Display</h3>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-orbit-paths" checked>
                                    Show Orbit Paths (O key toggles)
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-satellite-labels" checked>
                                    Show Satellite Labels
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-ground-stations" checked>
                                    Show Ground Stations
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-line-of-sight" checked>
                                    Show Line-of-Sight Connections
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-earth-atmosphere" checked>
                                    Show Earth Atmosphere Effect
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-sunlight" checked>
                                    Show Day/Night Terminator
                                </label>
                            </div>
                        </div>

                        <div class="setting-section">
                            <h3>üõ∞Ô∏è Satellite Appearance</h3>
                            <div class="setting-item">
                                <label for="satellite-scale">Satellite Size:</label>
                                <input type="range" id="satellite-scale" min="0.5" max="3.0" step="0.1" value="1.0">
                                <span id="satellite-scale-value">100%</span>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-satellite-glow" checked>
                                    Satellite Glow Effect
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="realistic-lighting" checked>
                                    Realistic Solar Lighting
                                </label>
                            </div>
                            <div class="setting-item">
                                <label for="label-scale">Label Size:</label>
                                <input type="range" id="label-scale" min="0.5" max="2.0" step="0.1" value="1.0">
                                <span id="label-scale-value">100%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Trails Tab -->
                    <div class="tab-content" id="trails-tab" style="display: none;">
                        <div class="setting-section">
                            <h3>üåå Orbit Trails</h3>
                            <div class="setting-item">
                                <label for="trail-length">Trail History (minutes):</label>
                                <input type="range" id="trail-length" min="30" max="360" step="30" value="180">
                                <span id="trail-length-value">180 min</span>
                            </div>
                            <div class="setting-item">
                                <label for="trail-quality">Trail Quality:</label>
                                <select id="trail-quality">
                                    <option value="low">Low (better performance)</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High (best quality)</option>
                                    <option value="ultra">Ultra (maximum realism)</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label for="trail-opacity">Trail Opacity:</label>
                                <input type="range" id="trail-opacity" min="0.1" max="1.0" step="0.1" value="0.8">
                                <span id="trail-opacity-value">80%</span>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="trail-fade-gradient" checked>
                                    Fade gradient (older trails dimmer)
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Camera Tab -->
                    <div class="tab-content" id="camera-tab" style="display: none;">
                        <div class="setting-section">
                            <h3>üìπ Camera & Controls</h3>
                            <div class="setting-item">
                                <label for="camera-sensitivity">Mouse Sensitivity:</label>
                                <input type="range" id="camera-sensitivity" min="0.1" max="2.0" step="0.1" value="1.0">
                                <span id="camera-sensitivity-value">100%</span>
                            </div>
                            <div class="setting-item">
                                <label for="zoom-speed">Zoom Speed:</label>
                                <input type="range" id="zoom-speed" min="0.5" max="3.0" step="0.1" value="1.0">
                                <span id="zoom-speed-value">100%</span>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="smooth-camera" checked>
                                    Smooth Camera Transitions
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="auto-follow-satellite">
                                    Auto-follow Active Satellite
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Tab -->
                    <div class="tab-content" id="advanced-tab" style="display: none;">
                        <div class="setting-section">
                            <h3>üî¨ Advanced Settings</h3>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-coordinate-system">
                                    Show Coordinate System
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="show-orbital-mechanics">
                                    Show Orbital Mechanics Info
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="enable-physics-debug">
                                    Enable Physics Debug Mode
                                </label>
                            </div>
                            <div class="setting-item">
                                <label for="earth-rotation-rate">Earth Rotation Rate:</label>
                                <input type="range" id="earth-rotation-rate" min="0.1" max="2.0" step="0.1" value="1.0">
                                <span id="earth-rotation-rate-value">100%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="settings-presets" style="padding: 8px; border-radius: 4px; background: rgba(0,23,40,0.9); color: #66d9ff; border: 1px solid #00cfff;">
                            <option value="">Load Preset...</option>
                            <option value="performance">Performance Mode</option>
                            <option value="quality">Quality Mode</option>
                            <option value="cinematic">Cinematic Mode</option>
                            <option value="educational">Educational Mode</option>
                            <option value="developer">Developer Mode</option>
                        </select>
                        <button class="secondary-button" id="settings-reset-button">Reset to Defaults</button>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="primary-button" id="settings-apply-button">Apply Settings</button>
                        <button class="primary-button" id="settings-modal-close-footer" style="background: rgba(102,217,255,0.1); border-color: #66d9ff;">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Floating Time Display -->
        <div id="time-display" class="floating-display" style="position:absolute; top:24px; left:50%; transform:translateX(-50%); z-index:3000; min-width:220px; text-align:center;">
            <div id="current-time" style="font-size:1.18em; font-weight:600; letter-spacing:0.04em; color:#66d9ff; background:rgba(0,23,40,0.92); border-radius:8px; padding:0.5em 1.2em; box-shadow:0 2px 12px #00cfff33; border:1px solid #00cfff; display:inline-block; cursor:pointer;">
                00:00:00 UTC
            </div>
            <div id="time-controls" class="time-controls-panel hidden" style="margin-top:8px;">
                <button class="time-btn speed-btn" data-mult="0.25">0.25x</button>
                <button class="time-btn speed-btn" data-mult="0.5">0.5x</button>
                <button class="time-btn speed-btn" data-mult="1">1x</button>
                <button class="time-btn speed-btn" data-mult="2">2x</button>
                <button class="time-btn speed-btn" data-mult="4">4x</button>
            </div>
            <div id="time-info-note" style="display:none; position:absolute; left:50%; top:calc(100% + 18px); transform:translateX(-50%); min-width:600px; max-width:900px; background:rgba(10,18,32,0.98); color:#66d9ff; font-size:1em; border-radius:22px; box-shadow:0 8px 36px #00cfff22; padding:1.5em 2.8em 1.5em 2.2em; z-index:3500; text-align:left; border:none; line-height:1.7; pointer-events:auto; outline:none; display:flex; flex-direction:column; gap:0.5em; align-items:flex-start; font-weight:400; opacity:0.97;">
                <b>Tip:</b> Simulation time runs at a 60:1 ratio (1 real second = 1 simulated minute). The speed you select multiplies this effect.
            </div>
        </div>
        
        <!-- Mission Dashboard Overlay (hidden by default) -->
        <div id="mission-dashboard" class="mission-dashboard-overlay hidden">
            <div class="mission-dashboard-tile left-tile">
                <div class="tile-header ambient-blue">Mission Telemetry</div>
                <div class="tile-content" id="mission-telemetry-content">
                    <!-- Telemetry, graphs, and subsystem data will go here -->
                    <div class="telemetry-placeholder">Select a satellite to view telemetry.</div>
                </div>
            </div>
            <div class="mission-dashboard-tile model-tile">
                <div class="tile-header ambient-orange">3D Satellite Model</div>
                <div class="tile-content" id="mission-model-content">
                    <!-- 3D model viewer canvas -->
                    <canvas id="modelCanvas" style="width:100%; height:100%; display:block; position:absolute; top:0; left:0; z-index:10;"></canvas>
                </div>
            </div>
            <button id="close-mission-dashboard" class="close-mission-dashboard">&times;</button>
        </div>
    </div>

    <script>
        const facts = [
            'There are over 34,000 objects larger than 10cm currently orbiting Earth.',
            'The ISS travels at approximately 7.66 km/s to stay in orbit.',
            'The Moon drifts away from Earth at about 3.8 cm per year.',
            'A day on Venus is longer than its year due to its slow rotation.',
            'Saturn‚Äôs rings consist mostly of ice particles mixed with rock.'
        ];
        let factIndex = 0;
        function rotateFact() {
            factIndex = (factIndex + 1) % facts.length;
            document.querySelector('#space-fact p').textContent = facts[factIndex];
        }
        // Start rotating facts immediately
        rotateFact();
        setInterval(rotateFact, 4000);

        // Show/hide the note and controls only on click, and auto-hide tip after timeout or click-out
        (function() {
            const timeDisplay = document.getElementById('time-display');
            const currentTime = document.getElementById('current-time');
            const controlsPanel = document.getElementById('time-controls');
            const note = document.getElementById('time-info-note');
            let tipTimeout = null;
            let controlsOpen = false;

            // Ensure tip and controls are hidden on page load
            controlsPanel.classList.add('hidden');
            note.style.display = 'none';

            function showControlsAndTip() {
                controlsPanel.classList.remove('hidden');
                note.style.display = 'flex';
                controlsOpen = true;
                clearTimeout(tipTimeout);
                tipTimeout = setTimeout(hideTipAndControls, 10000); // auto-hide after 10s
            }
            function hideTipAndControls() {
                controlsPanel.classList.add('hidden');
                note.style.display = 'none';
                controlsOpen = false;
                clearTimeout(tipTimeout);
            }
            currentTime.addEventListener('click', function(e) {
                e.stopPropagation();
                if (!controlsOpen) {
                    showControlsAndTip();
                } else {
                    hideTipAndControls();
                }
            });
            // Hide when clicking outside
            document.addEventListener('mousedown', function(e) {
                if (!timeDisplay.contains(e.target)) {
                    hideTipAndControls();
                }
            });
            // Hide on ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') hideTipAndControls();
            });
            // Prevent accidental close when clicking inside
            controlsPanel.addEventListener('mousedown', function(e) { e.stopPropagation(); });
            note.addEventListener('mousedown', function(e) { e.stopPropagation(); });
        })();
        // Hide time display during loading screen
        (function() {
            const loadingScreen = document.getElementById('loading-screen');
            const body = document.body;
            function updateTimeDisplayVisibility() {
                if (loadingScreen && loadingScreen.style.display !== 'none') {
                    body.classList.add('hide-time');
                } else {
                    body.classList.remove('hide-time');
                }
            }
            // Initial check
            updateTimeDisplayVisibility();
            // Observe loading screen visibility changes
            const observer = new MutationObserver(updateTimeDisplayVisibility);
            observer.observe(loadingScreen, { attributes: true, attributeFilter: ['style'] });
        })();
        // Make time control buttons clickable even when tip/controls are open
        (function() {
            const controlsPanel = document.getElementById('time-controls');
            const timeDisplay = document.getElementById('time-display');
            // Ensure pointer events are enabled
            controlsPanel.style.pointerEvents = 'auto';
            timeDisplay.style.pointerEvents = 'auto';
        })();
        // Toggle all control buttons visibility with loading screen
        (function() {
            const loadingScreen = document.getElementById('loading-screen');
            const helpBtn = document.getElementById('help-sphere-btn');
            const sdaBtn = document.getElementById('sda-toggle-btn');
            const gearBtn = document.getElementById('simulation-settings-btn');
            
            function updateButtonVisibility() {
                if (loadingScreen.style.display === 'none') {
                    // Show all buttons when simulation is loaded
                    helpBtn.style.display = 'block';
                    sdaBtn.style.display = 'flex'; // Use flex for proper icon alignment
                    gearBtn.style.display = 'flex'; // Use flex for proper icon alignment
                } else {
                    // Hide all buttons during loading
                    helpBtn.style.display = 'none';
                    sdaBtn.style.display = 'none';
                    gearBtn.style.display = 'none';
                }
            }
            // Observe loading screen hiding
            const observer = new MutationObserver(updateButtonVisibility);
            observer.observe(loadingScreen, { attributes: true, attributeFilter: ['style'] });
            // Initial check
            updateButtonVisibility();
        })();
        // Help sphere toggle - now shows welcome modal
        (function() {
            const helpBtn = document.getElementById('help-sphere-btn');
            const welcomeModal = document.getElementById('welcome-modal');
            const canvas = document.getElementById('renderCanvas');
            
            // Note: Help button click handler is set up in brand-ui.js showHelpButton function
            
            // Close modal when clicking on simulation canvas
            if (canvas && welcomeModal) {
                canvas.addEventListener('click', () => {
                    welcomeModal.style.display = 'none';
                });
            }
        })();
        
        // SDA Welcome Modal functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sdaToggleBtn = document.getElementById('sda-toggle-btn');
            const sdaModal = document.getElementById('sda-welcome-modal');
            const sdaCloseBtn = document.getElementById('sda-modal-close');
            const sdaCloseBtnFooter = document.getElementById('sda-modal-close-footer');
            const sdaActivateBtn = document.getElementById('sda-activate-button');
            
            if (!sdaToggleBtn || !sdaModal) {
                console.log('SDA elements not found');
                return;
            }
            
            // SDA button event listener is now handled in app.js
            // to prevent duplicate event listeners
            // All modal handlers also moved to app.js to avoid conflicts
            console.log('SDA functionality will be initialized in app.js');
        });
    </script>
    <!-- SDA button click binding now handled in app.js -->
  </body>
</html>
